<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>amqp &mdash; Logtalk 3.98.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d75fae25" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=396eccfe" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=fd83a980"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <!-- begin favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5" />
    <meta name="msapplication-TileColor" content="#355b95" />
    <meta name="theme-color" content="#ffffff" />
    <!-- end favicon -->
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="arbitrary" href="arbitrary.html" />
    <link rel="prev" title="ada_boost" href="ada_boost.html" />
   
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            The Logtalk Handbook
              <img src="../_static/logtalk.gif" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.98.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../userman/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../refman/index.html">Reference Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devtools/index.html">Developer Tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="ada_boost.html"><code class="docutils literal notranslate"><span class="pre">ada_boost</span></code></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">amqp</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#api-documentation">API documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading">Loading</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing">Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#connecting-to-an-amqp-server">Connecting to an AMQP server</a></li>
<li class="toctree-l4"><a class="reference internal" href="#opening-a-channel">Opening a channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#declaring-exchanges-and-queues">Declaring exchanges and queues</a></li>
<li class="toctree-l4"><a class="reference internal" href="#publishing-messages">Publishing messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#consuming-messages">Consuming messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#synchronous-get">Synchronous get</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quality-of-service">Quality of Service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transactions">Transactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#publisher-confirms-rabbitmq-extension">Publisher Confirms (RabbitMQ extension)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#closing-connections">Closing connections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#connection-pooling">Connection Pooling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#defining-a-pool">Defining a pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initializing-the-pool">Initializing the pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acquiring-and-releasing-connections">Acquiring and releasing connections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-with-connection-1">Using with_connection/1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pool-statistics">Pool statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resizing-the-pool">Resizing the pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="#destroying-the-pool">Destroying the pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-pools-dynamically">Creating pools dynamically</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#binary-frame-encoding">Binary Frame Encoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#frame-structure">Frame structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#encoding-decoding-frames">Encoding/decoding frames</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#data-types">Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#float-double-encoding-decoding">Float/Double Encoding/Decoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#error-handling">Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comparison-with-stomp">Comparison with STOMP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#future-work">Future Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="#known-limitations-and-issues">Known Limitations and Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="#amqp-1-0-vs-amqp-0-9-1">AMQP 1.0 vs AMQP 0-9-1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="arbitrary.html"><code class="docutils literal notranslate"><span class="pre">arbitrary</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="assignvars.html"><code class="docutils literal notranslate"><span class="pre">assignvars</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="avro.html"><code class="docutils literal notranslate"><span class="pre">avro</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="base32.html"><code class="docutils literal notranslate"><span class="pre">base32</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="base58.html"><code class="docutils literal notranslate"><span class="pre">base58</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="base64.html"><code class="docutils literal notranslate"><span class="pre">base64</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="base85.html"><code class="docutils literal notranslate"><span class="pre">base85</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="basic_types.html"><code class="docutils literal notranslate"><span class="pre">basic_types</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="c45.html"><code class="docutils literal notranslate"><span class="pre">c45</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="cbor.html"><code class="docutils literal notranslate"><span class="pre">cbor</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="ccsds.html"><code class="docutils literal notranslate"><span class="pre">ccsds</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="classifier_protocols.html"><code class="docutils literal notranslate"><span class="pre">classifier_protocols</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="combinations.html"><code class="docutils literal notranslate"><span class="pre">combinations</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="command_line_options.html"><code class="docutils literal notranslate"><span class="pre">command_line_options</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html"><code class="docutils literal notranslate"><span class="pre">core</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="coroutining.html"><code class="docutils literal notranslate"><span class="pre">coroutining</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="csv.html"><code class="docutils literal notranslate"><span class="pre">csv</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="datalog.html"><code class="docutils literal notranslate"><span class="pre">datalog</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dates.html"><code class="docutils literal notranslate"><span class="pre">dates</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dependents.html"><code class="docutils literal notranslate"><span class="pre">dependents</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="deques.html"><code class="docutils literal notranslate"><span class="pre">deques</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dictionaries.html"><code class="docutils literal notranslate"><span class="pre">dictionaries</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dif.html"><code class="docutils literal notranslate"><span class="pre">dif</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="edcg.html"><code class="docutils literal notranslate"><span class="pre">edcg</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html"><code class="docutils literal notranslate"><span class="pre">events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expand_library_alias_paths.html"><code class="docutils literal notranslate"><span class="pre">expand_library_alias_paths</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="expecteds.html"><code class="docutils literal notranslate"><span class="pre">expecteds</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="format.html"><code class="docutils literal notranslate"><span class="pre">format</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="genint.html"><code class="docutils literal notranslate"><span class="pre">genint</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="gensym.html"><code class="docutils literal notranslate"><span class="pre">gensym</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="geospatial.html"><code class="docutils literal notranslate"><span class="pre">geospatial</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="git.html"><code class="docutils literal notranslate"><span class="pre">git</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="grammars.html"><code class="docutils literal notranslate"><span class="pre">grammars</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="graphs.html"><code class="docutils literal notranslate"><span class="pre">graphs</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="heaps.html"><code class="docutils literal notranslate"><span class="pre">heaps</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hierarchies.html"><code class="docutils literal notranslate"><span class="pre">hierarchies</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hook_flows.html"><code class="docutils literal notranslate"><span class="pre">hook_flows</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hook_objects.html"><code class="docutils literal notranslate"><span class="pre">hook_objects</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="html.html"><code class="docutils literal notranslate"><span class="pre">html</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="ids.html"><code class="docutils literal notranslate"><span class="pre">ids</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="intervals.html"><code class="docutils literal notranslate"><span class="pre">intervals</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="isolation_forest.html"><code class="docutils literal notranslate"><span class="pre">isolation_forest</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="java.html"><code class="docutils literal notranslate"><span class="pre">java</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="json.html"><code class="docutils literal notranslate"><span class="pre">json</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="json_ld.html"><code class="docutils literal notranslate"><span class="pre">json_ld</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="json_lines.html"><code class="docutils literal notranslate"><span class="pre">json_lines</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="json_rpc.html"><code class="docutils literal notranslate"><span class="pre">json_rpc</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="json_schema.html"><code class="docutils literal notranslate"><span class="pre">json_schema</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="knn.html"><code class="docutils literal notranslate"><span class="pre">knn</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="linda.html"><code class="docutils literal notranslate"><span class="pre">linda</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="listing.html"><code class="docutils literal notranslate"><span class="pre">listing</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html"><code class="docutils literal notranslate"><span class="pre">logging</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="loops.html"><code class="docutils literal notranslate"><span class="pre">loops</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="mcp_server.html"><code class="docutils literal notranslate"><span class="pre">mcp_server</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="memcached.html"><code class="docutils literal notranslate"><span class="pre">memcached</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="meta.html"><code class="docutils literal notranslate"><span class="pre">meta</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="meta_compiler.html"><code class="docutils literal notranslate"><span class="pre">meta_compiler</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="mutations.html"><code class="docutils literal notranslate"><span class="pre">mutations</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="nanoid.html"><code class="docutils literal notranslate"><span class="pre">nanoid</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="naive_bayes.html"><code class="docutils literal notranslate"><span class="pre">naive_bayes</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="nearest_centroid.html"><code class="docutils literal notranslate"><span class="pre">nearest_centroid</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="nested_dictionaries.html"><code class="docutils literal notranslate"><span class="pre">nested_dictionaries</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="optionals.html"><code class="docutils literal notranslate"><span class="pre">optionals</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="options.html"><code class="docutils literal notranslate"><span class="pre">options</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="os.html"><code class="docutils literal notranslate"><span class="pre">os</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="permutations.html"><code class="docutils literal notranslate"><span class="pre">permutations</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html"><code class="docutils literal notranslate"><span class="pre">process</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="protobuf.html"><code class="docutils literal notranslate"><span class="pre">protobuf</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="queues.html"><code class="docutils literal notranslate"><span class="pre">queues</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html"><code class="docutils literal notranslate"><span class="pre">random</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="random_forest.html"><code class="docutils literal notranslate"><span class="pre">random_forest</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="reader.html"><code class="docutils literal notranslate"><span class="pre">reader</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="recorded_database.html"><code class="docutils literal notranslate"><span class="pre">recorded_database</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="redis.html"><code class="docutils literal notranslate"><span class="pre">redis</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="sets.html"><code class="docutils literal notranslate"><span class="pre">sets</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="sockets.html"><code class="docutils literal notranslate"><span class="pre">sockets</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="simulated_annealing.html"><code class="docutils literal notranslate"><span class="pre">simulated_annealing</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="statistics.html"><code class="docutils literal notranslate"><span class="pre">statistics</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="stemming.html"><code class="docutils literal notranslate"><span class="pre">stemming</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="stomp.html"><code class="docutils literal notranslate"><span class="pre">stomp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="string_distance.html"><code class="docutils literal notranslate"><span class="pre">string_distance</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="strings.html"><code class="docutils literal notranslate"><span class="pre">strings</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subsequences.html"><code class="docutils literal notranslate"><span class="pre">subsequences</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="term_io.html"><code class="docutils literal notranslate"><span class="pre">term_io</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="time_scales.html"><code class="docutils literal notranslate"><span class="pre">time_scales</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="timeout.html"><code class="docutils literal notranslate"><span class="pre">timeout</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="toon.html"><code class="docutils literal notranslate"><span class="pre">toon</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="tsv.html"><code class="docutils literal notranslate"><span class="pre">tsv</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html"><code class="docutils literal notranslate"><span class="pre">types</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="ulid.html"><code class="docutils literal notranslate"><span class="pre">ulid</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="unicode_data.html"><code class="docutils literal notranslate"><span class="pre">unicode_data</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="union_find.html"><code class="docutils literal notranslate"><span class="pre">union_find</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="url.html"><code class="docutils literal notranslate"><span class="pre">url</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="uuid.html"><code class="docutils literal notranslate"><span class="pre">uuid</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="validations.html"><code class="docutils literal notranslate"><span class="pre">validations</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="yaml.html"><code class="docutils literal notranslate"><span class="pre">yaml</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="zippers.html"><code class="docutils literal notranslate"><span class="pre">zippers</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ports/index.html">Ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributions/index.html">Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

    <p class="caption"><span class="caption-text">External Contents</span></p>
    <ul>
    <li class="toctree-l1"><a class="reference internal" href="../../apis/index.html">APIs</a></li>
    <li class="toctree-l1"><a class="reference internal" href="https://logtalk.org">Logtalk website</a></li>
    <li class="toctree-l1"><a class="reference internal" href="https://github.com/LogtalkDotOrg/logtalk3">GitHub repo</a></li>
    </ul>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Logtalk Handbook</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Libraries</a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">amqp</span></code></li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/LogtalkDotOrg/logtalk3/blob/master/docs/handbook/sources/libraries/amqp.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="amqp">
<span id="library-amqp"></span><h1><code class="docutils literal notranslate"><span class="pre">amqp</span></code><a class="headerlink" href="#amqp" title="Link to this heading"></a></h1>
<p>Portable AMQP 0-9-1 (Advanced Message Queuing Protocol) client
implementation. This library uses the <code class="docutils literal notranslate"><span class="pre">sockets</span></code> library and supports
all backend Prolog systems supported by that library: ECLiPSe, GNU
Prolog, SICStus Prolog, SWI-Prolog, Trealla Prolog, and XVM.</p>
<p><a class="reference external" href="https://www.rabbitmq.com/amqp-0-9-1-reference.html">https://www.rabbitmq.com/amqp-0-9-1-reference.html</a></p>
<p>AMQP 0-9-1 is a binary wire-level protocol for message-oriented
middleware. It is the de facto standard for message broker
interoperability and is supported by RabbitMQ, Apache Qpid, Apache
ActiveMQ, and other brokers.</p>
<section id="api-documentation">
<h2>API documentation<a class="headerlink" href="#api-documentation" title="Link to this heading"></a></h2>
<p>Open the
<a class="reference external" href="../../apis/library_index.html#amqp">../../apis/library_index.html#amqp</a>
link in a web browser.</p>
</section>
<section id="loading">
<h2>Loading<a class="headerlink" href="#loading" title="Link to this heading"></a></h2>
<p>To load this library, load the <code class="docutils literal notranslate"><span class="pre">loader.lgt</span></code> file:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span>| <span class="o">?-</span> <span class="k">logtalk_load</span>(amqp(loader)).
</pre></div>
</div>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Link to this heading"></a></h2>
<p>To test this library predicates, load the <code class="docutils literal notranslate"><span class="pre">tester.lgt</span></code> file:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span>| <span class="o">?-</span> <span class="k">logtalk_load</span>(amqp(tester)).
</pre></div>
</div>
<p>Note: Integration tests require a running AMQP 0-9-1 server (e.g.,
RabbitMQ). RabbitMQ AMQP listens on port 5672 by default with
guest/guest credentials.</p>
</section>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Full AMQP 0-9-1 protocol support with binary frame encoding/decoding</p></li>
<li><p>Connection management with heartbeat negotiation</p></li>
<li><p>Automatic reconnection with configurable retry attempts and delays</p></li>
<li><p>Connection pooling with automatic connection management</p></li>
<li><p>Multiple concurrent channels over a single connection</p></li>
<li><p>Exchange operations: declare, delete, bind, unbind</p></li>
<li><p>Queue operations: declare, delete, bind, unbind, purge</p></li>
<li><p>Basic messaging: publish, consume, get, ack, nack, reject</p></li>
<li><p>Quality of service (QoS) with prefetch settings</p></li>
<li><p>Transaction support: tx.select, tx.commit, tx.rollback</p></li>
<li><p>Publisher confirms (RabbitMQ extension)</p></li>
<li><p>SASL PLAIN authentication</p></li>
<li><p>Custom message properties and headers</p></li>
<li><p>Content properties: content-type, delivery-mode, priority, etc.</p></li>
</ul>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<section id="connecting-to-an-amqp-server">
<h3>Connecting to an AMQP server<a class="headerlink" href="#connecting-to-an-amqp-server" title="Link to this heading"></a></h3>
<p>Basic connection to RabbitMQ with default settings:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>connect(localhost, <span class="m">5672</span>, <span class="nv">Connection</span>, []).
</pre></div>
</div>
<p>Connection with custom credentials and virtual host:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>connect(localhost, <span class="m">5672</span>, <span class="nv">Connection</span>, [
    username(<span class="s">&#39;myuser&#39;</span>),
    password(<span class="s">&#39;mypassword&#39;</span>),
    virtual_host(<span class="s">&#39;/myvhost&#39;</span>),
    heartbeat(<span class="m">30</span>)
]).
</pre></div>
</div>
<p>Connection with automatic reconnection enabled:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>connect(localhost, <span class="m">5672</span>, <span class="nv">Connection</span>, [
    reconnect(<span class="k">true</span>),
    reconnect_attempts(<span class="m">5</span>),
    reconnect_delay(<span class="m">2</span>)
]).
</pre></div>
</div>
<p>This will attempt to connect up to 5 times with a 2 second delay between
attempts. If all attempts fail, an <code class="docutils literal notranslate"><span class="pre">amqp_error(reconnect_failed)</span></code>
error is thrown. The reconnection options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reconnect(Boolean)</span></code> - Enable automatic reconnection (default:
<code class="docutils literal notranslate"><span class="pre">false</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reconnect_attempts(N)</span></code> - Maximum number of connection attempts
(default: <code class="docutils literal notranslate"><span class="pre">3</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reconnect_delay(Seconds)</span></code> - Delay between attempts in seconds
(default: <code class="docutils literal notranslate"><span class="pre">1</span></code>)</p></li>
</ul>
</section>
<section id="opening-a-channel">
<h3>Opening a channel<a class="headerlink" href="#opening-a-channel" title="Link to this heading"></a></h3>
<p>AMQP operations require a channel. Open one on the connection:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>channel_open(<span class="nv">Connection</span>, <span class="m">1</span>, <span class="nv">Channel</span>).
</pre></div>
</div>
<p>You can open multiple channels (with different numbers) on a single
connection.</p>
</section>
<section id="declaring-exchanges-and-queues">
<h3>Declaring exchanges and queues<a class="headerlink" href="#declaring-exchanges-and-queues" title="Link to this heading"></a></h3>
<p>Declare a direct exchange:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>exchange_declare(<span class="nv">Channel</span>, <span class="s">&#39;my.exchange&#39;</span>, [
    type(direct),
    durable(<span class="k">true</span>)
]).
</pre></div>
</div>
<p>Declare a queue:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>queue_declare(<span class="nv">Channel</span>, <span class="s">&#39;my.queue&#39;</span>, [
    durable(<span class="k">true</span>),
    auto_delete(<span class="k">false</span>)
]).
</pre></div>
</div>
<p>Declare a queue with server-generated name:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>queue_declare(<span class="nv">Channel</span>, <span class="nv">Queue</span>, [exclusive(<span class="k">true</span>)]).
<span class="c">% Queue will be unified with the generated name</span>
</pre></div>
</div>
<p>Bind a queue to an exchange:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>queue_bind(<span class="nv">Channel</span>, <span class="s">&#39;my.queue&#39;</span>, <span class="s">&#39;my.exchange&#39;</span>, [
    routing_key(<span class="s">&#39;my.routing.key&#39;</span>)
]).
</pre></div>
</div>
</section>
<section id="publishing-messages">
<h3>Publishing messages<a class="headerlink" href="#publishing-messages" title="Link to this heading"></a></h3>
<p>Publish a simple message:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>basic_publish(<span class="nv">Channel</span>, <span class="s">&#39;my.exchange&#39;</span>, <span class="s">&#39;Hello, World!&#39;</span>, [
    routing_key(<span class="s">&#39;my.routing.key&#39;</span>)
]).
</pre></div>
</div>
<p>Publish with properties:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>basic_publish(<span class="nv">Channel</span>, <span class="s">&#39;my.exchange&#39;</span>, <span class="s">&#39;{&quot;data&quot;: &quot;json&quot;}&#39;</span>, [
    routing_key(<span class="s">&#39;my.routing.key&#39;</span>),
    content_type(<span class="s">&#39;application/json&#39;</span>),
    delivery_mode(<span class="m">2</span>),  <span class="c">% persistent</span>
    correlation_id(<span class="s">&#39;abc123&#39;</span>),
    reply_to(<span class="s">&#39;reply.queue&#39;</span>)
]).
</pre></div>
</div>
<p>Publish with custom headers:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>basic_publish(<span class="nv">Channel</span>, <span class="s">&#39;my.exchange&#39;</span>, <span class="s">&#39;Message&#39;</span>, [
    routing_key(<span class="s">&#39;my.key&#39;</span>),
    headers([
        <span class="s">&#39;x-custom-header&#39;</span><span class="o">-</span>longstr(<span class="s">&#39;value&#39;</span>),
        <span class="s">&#39;x-priority&#39;</span><span class="o">-</span>int(<span class="m">5</span>)
    ])
]).
</pre></div>
</div>
</section>
<section id="consuming-messages">
<h3>Consuming messages<a class="headerlink" href="#consuming-messages" title="Link to this heading"></a></h3>
<p>Start a consumer:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>basic_consume(<span class="nv">Channel</span>, <span class="s">&#39;my.queue&#39;</span>, [
    consumer_tag(<span class="s">&#39;my-consumer&#39;</span>),
    no_ack(<span class="k">false</span>)
]).
</pre></div>
</div>
<p>Receive messages:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>receive(<span class="nv">Channel</span>, <span class="nv">Message</span>, [timeout(<span class="m">5000</span>)]).
</pre></div>
</div>
<p>Extract message data:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>message_body(<span class="nv">Message</span>, <span class="nv">Body</span>),
   amqp<span class="o">::</span>message_delivery_tag(<span class="nv">Message</span>, <span class="nv">DeliveryTag</span>),
   amqp<span class="o">::</span>message_property(<span class="nv">Message</span>, content_type, <span class="nv">ContentType</span>).
</pre></div>
</div>
<p>Acknowledge a message:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>basic_ack(<span class="nv">Channel</span>, <span class="nv">DeliveryTag</span>, []).
</pre></div>
</div>
<p>Reject a message:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>basic_reject(<span class="nv">Channel</span>, <span class="nv">DeliveryTag</span>, [requeue(<span class="k">true</span>)]).
</pre></div>
</div>
</section>
<section id="synchronous-get">
<h3>Synchronous get<a class="headerlink" href="#synchronous-get" title="Link to this heading"></a></h3>
<p>Get a single message synchronously:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>basic_get(<span class="nv">Channel</span>, <span class="s">&#39;my.queue&#39;</span>, [no_ack(<span class="k">false</span>)]).
</pre></div>
</div>
</section>
<section id="quality-of-service">
<h3>Quality of Service<a class="headerlink" href="#quality-of-service" title="Link to this heading"></a></h3>
<p>Set prefetch count to limit unacknowledged messages:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>basic_qos(<span class="nv">Channel</span>, [prefetch_count(<span class="m">10</span>)]).
</pre></div>
</div>
</section>
<section id="transactions">
<h3>Transactions<a class="headerlink" href="#transactions" title="Link to this heading"></a></h3>
<p>Enable transactions on a channel:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>tx_select(<span class="nv">Channel</span>).
</pre></div>
</div>
<p>Publish messages within a transaction:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>basic_publish(<span class="nv">Channel</span>, <span class="s">&#39;exchange&#39;</span>, <span class="s">&#39;Msg1&#39;</span>, [routing_key(<span class="s">&#39;key&#39;</span>)]),
   amqp<span class="o">::</span>basic_publish(<span class="nv">Channel</span>, <span class="s">&#39;exchange&#39;</span>, <span class="s">&#39;Msg2&#39;</span>, [routing_key(<span class="s">&#39;key&#39;</span>)]),
   amqp<span class="o">::</span>tx_commit(<span class="nv">Channel</span>).
</pre></div>
</div>
<p>Rollback a transaction:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>tx_rollback(<span class="nv">Channel</span>).
</pre></div>
</div>
</section>
<section id="publisher-confirms-rabbitmq-extension">
<h3>Publisher Confirms (RabbitMQ extension)<a class="headerlink" href="#publisher-confirms-rabbitmq-extension" title="Link to this heading"></a></h3>
<p>Enable publisher confirms:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>confirm_select(<span class="nv">Channel</span>).
</pre></div>
</div>
</section>
<section id="closing-connections">
<h3>Closing connections<a class="headerlink" href="#closing-connections" title="Link to this heading"></a></h3>
<p>Close a channel:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>channel_close(<span class="nv">Channel</span>).
</pre></div>
</div>
<p>Close the connection:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span><span class="k">close</span>(<span class="nv">Connection</span>).
</pre></div>
</div>
</section>
</section>
<section id="connection-pooling">
<h2>Connection Pooling<a class="headerlink" href="#connection-pooling" title="Link to this heading"></a></h2>
<p>The library provides connection pooling through the <code class="docutils literal notranslate"><span class="pre">amqp_pool</span></code>
category. To create a connection pool, define an object that imports
this category:</p>
<section id="defining-a-pool">
<h3>Defining a pool<a class="headerlink" href="#defining-a-pool" title="Link to this heading"></a></h3>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="p">:- </span><span class="k">object</span>(my_pool,
    <span class="k">imports</span>(amqp_pool)).
<span class="p">:- </span><span class="k">end_object</span>.
</pre></div>
</div>
</section>
<section id="initializing-the-pool">
<h3>Initializing the pool<a class="headerlink" href="#initializing-the-pool" title="Link to this heading"></a></h3>
<p>Initialize the pool with configuration options:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> my_pool<span class="o">::</span>initialize([
    host(localhost),
    port(<span class="m">5672</span>),
    min_size(<span class="m">2</span>),
    max_size(<span class="m">10</span>),
    connection_options([
        username(<span class="s">&#39;guest&#39;</span>),
        password(<span class="s">&#39;guest&#39;</span>),
        virtual_host(<span class="s">&#39;/&#39;</span>)
    ])
]).
</pre></div>
</div>
<p>Pool configuration options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">host(Host)</span></code> - AMQP server hostname (default: <code class="docutils literal notranslate"><span class="pre">localhost</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">port(Port)</span></code> - AMQP server port (default: <code class="docutils literal notranslate"><span class="pre">5672</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_size(N)</span></code> - Minimum connections to maintain (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_size(N)</span></code> - Maximum connections allowed (default: <code class="docutils literal notranslate"><span class="pre">10</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">connection_options(Options)</span></code> - Options passed to
<code class="docutils literal notranslate"><span class="pre">amqp::connect/4</span></code> (default: <code class="docutils literal notranslate"><span class="pre">[]</span></code>)</p></li>
</ul>
</section>
<section id="acquiring-and-releasing-connections">
<h3>Acquiring and releasing connections<a class="headerlink" href="#acquiring-and-releasing-connections" title="Link to this heading"></a></h3>
<p>Manually acquire and release connections:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> my_pool<span class="o">::</span>acquire(<span class="nv">Connection</span>),
   amqp<span class="o">::</span>channel_open(<span class="nv">Connection</span>, <span class="m">1</span>, <span class="nv">Channel</span>),
   <span class="c">% ... use the channel ...</span>
   amqp<span class="o">::</span>channel_close(<span class="nv">Channel</span>),
   my_pool<span class="o">::</span>release(<span class="nv">Connection</span>).
</pre></div>
</div>
</section>
<section id="using-with-connection-1">
<h3>Using with_connection/1<a class="headerlink" href="#using-with-connection-1" title="Link to this heading"></a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">with_connection/1</span></code> for automatic connection management:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> my_pool<span class="o">::</span>with_connection(do_work).

do_work(<span class="nv">Connection</span>) <span class="o">:-</span>
    amqp<span class="o">::</span>channel_open(<span class="nv">Connection</span>, <span class="m">1</span>, <span class="nv">Channel</span>),
    amqp<span class="o">::</span>basic_publish(<span class="nv">Channel</span>, <span class="s">&#39;&#39;</span>, <span class="s">&#39;Hello!&#39;</span>, [routing_key(<span class="s">&#39;my.queue&#39;</span>)]),
    amqp<span class="o">::</span>channel_close(<span class="nv">Channel</span>).
</pre></div>
</div>
<p>The connection is automatically released even if the goal fails or
throws an exception.</p>
</section>
<section id="pool-statistics">
<h3>Pool statistics<a class="headerlink" href="#pool-statistics" title="Link to this heading"></a></h3>
<p>Get pool statistics:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> my_pool<span class="o">::</span>stats(stats(<span class="nv">Available</span>, <span class="nv">InUse</span>, <span class="nv">Total</span>, <span class="nv">MinSize</span>, <span class="nv">MaxSize</span>)).
</pre></div>
</div>
</section>
<section id="resizing-the-pool">
<h3>Resizing the pool<a class="headerlink" href="#resizing-the-pool" title="Link to this heading"></a></h3>
<p>Resize the pool at runtime:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> my_pool<span class="o">::</span>resize(<span class="m">5</span>, <span class="m">20</span>).
</pre></div>
</div>
</section>
<section id="destroying-the-pool">
<h3>Destroying the pool<a class="headerlink" href="#destroying-the-pool" title="Link to this heading"></a></h3>
<p>Close all connections and clear pool state:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> my_pool<span class="o">::</span>destroy.
</pre></div>
</div>
</section>
<section id="creating-pools-dynamically">
<h3>Creating pools dynamically<a class="headerlink" href="#creating-pools-dynamically" title="Link to this heading"></a></h3>
<p>Pools can also be created at runtime using <code class="docutils literal notranslate"><span class="pre">create_object/4</span></code>:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> <span class="k">create_object</span>(dynamic_pool, [imports(amqp_pool)], [], []),
   dynamic_pool<span class="o">::</span>initialize([host(localhost), port(<span class="m">5672</span>)]).
</pre></div>
</div>
</section>
</section>
<section id="binary-frame-encoding">
<h2>Binary Frame Encoding<a class="headerlink" href="#binary-frame-encoding" title="Link to this heading"></a></h2>
<p>AMQP 0-9-1 is a binary protocol. The library provides low-level encoding
and decoding predicates for working with raw frames:</p>
<section id="frame-structure">
<h3>Frame structure<a class="headerlink" href="#frame-structure" title="Link to this heading"></a></h3>
<p>An AMQP frame consists of:</p>
<ul class="simple">
<li><p>Type (1 byte): 1=method, 2=header, 3=body, 8=heartbeat</p></li>
<li><p>Channel (2 bytes): Channel number (0 for connection frames)</p></li>
<li><p>Size (4 bytes): Payload size</p></li>
<li><p>Payload (Size bytes): Frame-specific data</p></li>
<li><p>Frame end (1 byte): 0xCE marker</p></li>
</ul>
</section>
<section id="encoding-decoding-frames">
<h3>Encoding/decoding frames<a class="headerlink" href="#encoding-decoding-frames" title="Link to this heading"></a></h3>
<p>Encode a frame to bytes:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>encode_frame(<span class="nv">Frame</span>, <span class="nv">Bytes</span>).
</pre></div>
</div>
<p>Decode bytes to a frame:</p>
<div class="highlight-logtalk notranslate"><div class="highlight"><pre><span></span><span class="o">?-</span> amqp<span class="o">::</span>decode_frame(<span class="nv">Bytes</span>, <span class="nv">Frame</span>).
</pre></div>
</div>
</section>
</section>
<section id="data-types">
<h2>Data Types<a class="headerlink" href="#data-types" title="Link to this heading"></a></h2>
<p>The library handles AMQP data types automatically:</p>
<ul class="simple">
<li><p><strong>octet</strong>: 8-bit unsigned integer</p></li>
<li><p><strong>short</strong>: 16-bit unsigned integer (big-endian)</p></li>
<li><p><strong>long</strong>: 32-bit unsigned integer (big-endian)</p></li>
<li><p><strong>longlong</strong>: 64-bit unsigned integer (big-endian)</p></li>
<li><p><strong>shortstr</strong>: Short string (length &lt;= 255)</p></li>
<li><p><strong>longstr</strong>: Long string</p></li>
<li><p><strong>table</strong>: Field table (key-value pairs)</p></li>
<li><p><strong>array</strong>: Field array</p></li>
</ul>
<p>Field values in tables use type tags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bool(true/false)</span></code> - Boolean</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">byte(V)</span></code> - Signed 8-bit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">short(V)</span></code> - Signed 16-bit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(V)</span></code> - Signed 32-bit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">long(V)</span></code> - Signed 64-bit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float(V)</span></code> - 32-bit float</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">double(V)</span></code> - 64-bit float</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">longstr(V)</span></code> - Long string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table(Pairs)</span></code> - Nested table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">array(Values)</span></code> - Array</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timestamp(V)</span></code> - Timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">void</span></code> - No value</p></li>
</ul>
</section>
<section id="float-double-encoding-decoding">
<h2>Float/Double Encoding/Decoding<a class="headerlink" href="#float-double-encoding-decoding" title="Link to this heading"></a></h2>
<p>The library implements proper IEEE 754 encoding and decoding for
floating-point values:</p>
<p><strong>Float (32-bit IEEE 754 single precision):</strong></p>
<ul class="simple">
<li><p>Format: 1 sign bit + 8 exponent bits (bias 127) + 23 mantissa bits</p></li>
<li><p>Encoded as 4 bytes in big-endian order</p></li>
<li><p>Used for <code class="docutils literal notranslate"><span class="pre">float(Value)</span></code> field values</p></li>
</ul>
<p><strong>Double (64-bit IEEE 754 double precision):</strong></p>
<ul class="simple">
<li><p>Format: 1 sign bit + 11 exponent bits (bias 1023) + 52 mantissa bits</p></li>
<li><p>Encoded as 8 bytes in big-endian order</p></li>
<li><p>Used for <code class="docutils literal notranslate"><span class="pre">double(Value)</span></code> field values</p></li>
</ul>
<p><strong>Special values representation:</strong></p>
<p>The library represents IEEE 754 special values using Prolog compound
terms:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;infinity</span></code> - Positive infinity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;negative_infinity</span></code> - Negative infinity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;not_a_number</span></code> - NaN (Not a Number)</p></li>
</ul>
<p>These special values are automatically encoded to and decoded from their
standard IEEE 754 binary representations.</p>
<p><strong>Known limitation:</strong></p>
<p>Most Prolog backends cannot distinguish between <code class="docutils literal notranslate"><span class="pre">-0.0</span></code> and <code class="docutils literal notranslate"><span class="pre">0.0</span></code>
when comparing floating-point values. While the library correctly
encodes and decodes both positive and negative zero according to IEEE
754, these values will typically compare as equal in Prolog arithmetic
operations. This limitation is unlikely to affect typical AMQP messaging
applications.</p>
</section>
<section id="error-handling">
<h2>Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading"></a></h2>
<p>The library throws structured errors:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">amqp_error(connection_failed)</span></code> - TCP connection failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amqp_error(auth_failed)</span></code> - Authentication failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amqp_error(protocol_error(Msg))</span></code> - Protocol violation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amqp_error(channel_error(Msg))</span></code> - Channel-level error</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amqp_error(exchange_error(Msg))</span></code> - Exchange operation failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amqp_error(queue_error(Msg))</span></code> - Queue operation failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amqp_error(basic_error(Msg))</span></code> - Basic operation failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amqp_error(tx_error(Msg))</span></code> - Transaction error</p></li>
</ul>
</section>
<section id="comparison-with-stomp">
<h2>Comparison with STOMP<a class="headerlink" href="#comparison-with-stomp" title="Link to this heading"></a></h2>
<p>AMQP 0-9-1 and STOMP are both messaging protocols, but differ
significantly:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>AMQP 0-9-1</p></th>
<th class="head"><p>STOMP</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Protocol type</p></td>
<td><p>Binary</p></td>
<td><p>Text</p></td>
</tr>
<tr class="row-odd"><td><p>Complexity</p></td>
<td><p>High</p></td>
<td><p>Low</p></td>
</tr>
<tr class="row-even"><td><p>Exchange types</p></td>
<td><p>Multiple</p></td>
<td><p>Broker-dependent</p></td>
</tr>
<tr class="row-odd"><td><p>Routing</p></td>
<td><p>Flexible</p></td>
<td><p>Simple</p></td>
</tr>
<tr class="row-even"><td><p>Transactions</p></td>
<td><p>Native</p></td>
<td><p>Native</p></td>
</tr>
<tr class="row-odd"><td><p>QoS</p></td>
<td><p>Native prefetch</p></td>
<td><p>Limited</p></td>
</tr>
<tr class="row-even"><td><p>Performance</p></td>
<td><p>Higher</p></td>
<td><p>Lower</p></td>
</tr>
</tbody>
</table>
<p>Use AMQP when you need:</p>
<ul class="simple">
<li><p>Fine-grained routing control</p></li>
<li><p>High performance</p></li>
<li><p>Advanced message patterns</p></li>
<li><p>Exchange-based routing</p></li>
</ul>
<p>Use STOMP when you need:</p>
<ul class="simple">
<li><p>Simple text-based protocol</p></li>
<li><p>Easy debugging</p></li>
<li><p>Protocol simplicity</p></li>
</ul>
</section>
<section id="future-work">
<h2>Future Work<a class="headerlink" href="#future-work" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Logtalk protocols for messaging patterns (request/reply, pub/sub,
etc.)</p></li>
<li><p>Categories for common message transformations</p></li>
<li><p>Async message handlers</p></li>
</ul>
</section>
<section id="known-limitations-and-issues">
<h2>Known Limitations and Issues<a class="headerlink" href="#known-limitations-and-issues" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>SSL/TLS connections not yet supported (use stunnel or similar)</p></li>
<li><p>Heartbeat sending must be done manually via <code class="docutils literal notranslate"><span class="pre">send_heartbeat/1</span></code></p></li>
<li><p>Most Prolog backends cannot distinguish between <code class="docutils literal notranslate"><span class="pre">-0.0</span></code> and <code class="docutils literal notranslate"><span class="pre">0.0</span></code>
(see the “Float/Double Encoding/Decoding” section above for details)</p></li>
<li><p>GNU Prolog support is partial as it doesn’t currently support null
characters in atoms</p></li>
</ul>
</section>
<section id="amqp-1-0-vs-amqp-0-9-1">
<span id="amqp-10-vs-amqp-0-9-1"></span><h2>AMQP 1.0 vs AMQP 0-9-1<a class="headerlink" href="#amqp-1-0-vs-amqp-0-9-1" title="Link to this heading"></a></h2>
<p>This library implements AMQP 0-9-1 only. Despite the similar name,
<strong>AMQP 1.0 is a fundamentally different protocol</strong> and is not supported
by this library. The two versions are not wire-compatible and have
different conceptual models:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Aspect</p></th>
<th class="head"><p>AMQP 0-9-1</p></th>
<th class="head"><p>AMQP 1.0</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Design</p></td>
<td><p>Broker-centric</p></td>
<td><p>Peer-to-peer</p></td>
</tr>
<tr class="row-odd"><td><p>Routing</p></td>
<td><p>Exchanges + queues</p></td>
<td><p>Link-based addressing</p></td>
</tr>
<tr class="row-even"><td><p>Frame structure</p></td>
<td><p>Custom binary framing</p></td>
<td><p>Layered performatives</p></td>
</tr>
<tr class="row-odd"><td><p>Data encoding</p></td>
<td><p>Custom type system</p></td>
<td><p>CBOR-like encoding</p></td>
</tr>
</tbody>
</table>
<p><strong>Key differences:</strong></p>
<ul class="simple">
<li><p>AMQP 0-9-1 uses exchanges, bindings, and queues as core protocol
concepts</p></li>
<li><p>AMQP 1.0 abstracts these as broker-specific “nodes” and uses links</p></li>
<li><p>Frame encoding, handshake, and message format are completely different</p></li>
<li><p>Minimal code could be shared between the two implementations</p></li>
</ul>
<p>AMQP 1.0 support would require a separate library with its own distinct
API reflecting the link-based model, rather than the exchange/queue
model of AMQP 0-9-1.</p>
<p><strong>Practical note:</strong> RabbitMQ and most message brokers continue to
primarily use AMQP 0-9-1, making this library suitable for the vast
majority of use cases.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ada_boost.html" class="btn btn-neutral float-left" title="ada_boost" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="arbitrary.html" class="btn btn-neutral float-right" title="arbitrary" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1998-2026, Paulo Moura.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>